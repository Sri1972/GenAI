<!doctype html>
<html>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Sample Pie</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<style>
    body{font-family:Inter,Segoe UI,Arial,sans-serif;margin:20px;background:#f6f7fb;color:#111}
    .container{max-width:1100px;margin:0 auto;background:#fff;padding:20px;border-radius:8px;box-shadow:0 6px 30px rgba(20,30,60,0.08)}
    h2{margin:0 0 12px 0;font-size:18px}
    .viz{width:100%;height:520px}
    .legend{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .legend-item{display:flex;align-items:center;gap:8px;font-size:13px}
    .sw{width:14px;height:14px;border-radius:3px}
</style>
</head>
<body>
<div class='container'>
<h2>Sample Pie</h2>
<div id='viz' class='viz'></div>
<div id='legend' class='legend' aria-hidden='false'></div>
<div style='margin-top:8px;color:#666;font-size:13px'>Generated by local D3 MCP server</div>
</div>
<script src='https://d3js.org/d3.v7.min.js'></script>
<script>
const data = {"labels": ["A", "B", "C"], "datasets": [{"data": [40, 30, 30], "backgroundColor": ["#1f77b4", "#ff7f0e", "#2ca02c"]}]};

(function(){
const container = d3.select('#viz');
const rect = container.node().getBoundingClientRect();
const rectWidth = rect.width || container.node().clientWidth || document.documentElement.clientWidth || window.innerWidth || 800;
const rectHeight = rect.height || container.node().clientHeight || document.documentElement.clientHeight || window.innerHeight || 520;
const width = Math.min(600, rectWidth);
const height = Math.min(520, rectHeight);
const radius = Math.min(width, height)/2 - 10;
const svg = container.append('svg').attr('width', width).attr('height', height).append('g').attr('transform',`translate(${width/2},${height/2})`);
const labels = data.labels || [];
const ds = data.datasets && data.datasets[0] || {data:[], backgroundColor: []};
const data = (ds.data || []).map((v,i)=>({label: labels[i]||('Seg'+i), value: v||0, color: (ds.backgroundColor && ds.backgroundColor[i]) || ds.borderColor || d3.schemeTableau10[i%10]}));
const pie = d3.pie().value(d=>d.value);
const arc = d3.arc().innerRadius(0) .outerRadius(radius);
const arcs = svg.selectAll('arc').data(pie(data)).enter().append('g');
arcs.append('path').attr('d',arc).attr('fill',d=>d.data.color).attr('stroke','#fff').attr('stroke-width',1);
arcs.append('title').text(d=>d.data.label+': '+d.data.value);
// legends
const legend = d3.select('#legend');
data.forEach(d=>{ legend.append('div').attr('class','legend-item').html(`<div class='sw' style='background:${d.color}'></div><div>${d.label} â€” ${d.value}</div>`); });
})();

</script>
</body>
</html>
