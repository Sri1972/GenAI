<!doctype html>
<html>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Sample Bubble</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<style>
    body{font-family:Inter,Segoe UI,Arial,sans-serif;margin:20px;background:#f6f7fb;color:#111}
    .container{max-width:1100px;margin:0 auto;background:#fff;padding:20px;border-radius:8px;box-shadow:0 6px 30px rgba(20,30,60,0.08)}
    h2{margin:0 0 12px 0;font-size:18px}
    .viz{width:100%;height:520px}
    .legend{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .legend-item{display:flex;align-items:center;gap:8px;font-size:13px}
    .sw{width:14px;height:14px;border-radius:3px}
</style>
</head>
<body>
<div class='container'>
<h2>Sample Bubble</h2>
<div id='viz' class='viz'></div>
<div id='legend' class='legend' aria-hidden='false'></div>
<div style='margin-top:8px;color:#666;font-size:13px'>Generated by local D3 MCP server</div>
</div>
<script src='https://d3js.org/d3.v7.min.js'></script>
<script>
const data = {"datasets": [{"label": "Bubbles", "data": [{"x": 10, "y": 20, "r": 8}, {"x": 30, "y": 10, "r": 12}, {"x": 20, "y": 40, "r": 6}], "backgroundColor": ["#1f77b4", "#ff7f0e", "#2ca02c"]}]};

(function(){
const container = d3.select('#viz');
const rect = container.node().getBoundingClientRect();
const width = Math.max(300, rect.width || container.node().clientWidth || window.innerWidth || 800);
const height = Math.max(300, rect.height || container.node().clientHeight || window.innerHeight || 520);
const svg = container.append('svg').attr('width', width).attr('height', height).append('g').attr('transform','translate(40,20)');
const payload = data || {};
const datasets = payload.datasets || [];
if(!datasets.length){ container.append('div').text('No bubble data'); return; }
const points = datasets[0].data || [];
// compute scales
const xs = points.map(d=>+d.x||0), ys = points.map(d=>+d.y||0), rs = points.map(d=>+d.r||0);
const xScale = d3.scaleLinear().domain([d3.min(xs)||0, d3.max(xs)||1]).range([0, width-120]);
const yScale = d3.scaleLinear().domain([d3.min(ys)||0, d3.max(ys)||1]).range([height-80, 0]);
const rScale = d3.scaleSqrt().domain([d3.min(rs)||0, d3.max(rs)||1]).range([4, 40]);
// axes
const xAxis = d3.axisBottom(xScale).ticks(6);
const yAxis = d3.axisLeft(yScale).ticks(6);
svg.append('g').attr('transform',`translate(0,${height-80})`).call(xAxis);
svg.append('g').call(yAxis);
// points
const color = (datasets[0].backgroundColor && datasets[0].backgroundColor[0]) || '#1f77b4';
svg.selectAll('circle').data(points).enter().append('circle')
    .attr('cx',d=>xScale(+d.x||0))
    .attr('cy',d=>yScale(+d.y||0))
    .attr('r',d=>rScale(+d.r||0))
    .attr('fill', (d,i)=> (datasets[0].backgroundColor && datasets[0].backgroundColor[i]) || color)
    .attr('stroke','#fff').attr('stroke-width',1).attr('opacity',0.9)
    .on('mouseover', function(event,d){ const tip = d3.select('body').append('div').attr('id','tmpTip').style('position','absolute').style('padding','6px 8px').style('background','#222').style('color','#fff').style('border-radius','6px').style('pointer-events','none'); tip.html((d.label?d.label+'<br/>':'')+'x:'+d.x+' y:'+d.y+' size:'+d.r); })
    .on('mousemove', function(event){ d3.select('#tmpTip').style('left',(event.pageX+12)+'px').style('top',(event.pageY+12)+'px'); })
    .on('mouseout', function(){ d3.select('#tmpTip').remove(); });
// legend
d3.select('#legend').append('div').attr('class','legend-item').html(`<div class='sw' style='background:${color}'></div><div>${datasets[0].label||'series'}</div>`);
})();

</script>
</body>
</html>
