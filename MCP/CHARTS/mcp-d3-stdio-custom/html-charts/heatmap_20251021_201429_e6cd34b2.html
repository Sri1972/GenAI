<!doctype html>
<html>
<head>
<meta charset='utf-8'>
<meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Sample Heatmap</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<style>
    body{font-family:Inter,Segoe UI,Arial,sans-serif;margin:20px;background:#f6f7fb;color:#111}
    .container{max-width:1100px;margin:0 auto;background:#fff;padding:20px;border-radius:8px;box-shadow:0 6px 30px rgba(20,30,60,0.08)}
    h2{margin:0 0 12px 0;font-size:18px}
    .viz{width:100%;height:520px}
    .legend{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .legend-item{display:flex;align-items:center;gap:8px;font-size:13px}
    .sw{width:14px;height:14px;border-radius:3px}
</style>
</head>
<body>
<div class='container'>
<h2>Sample Heatmap</h2>
<div id='viz' class='viz'></div>
<div id='legend' class='legend' aria-hidden='false'></div>
<div style='margin-top:8px;color:#666;font-size:13px'>Generated by local D3 MCP server</div>
</div>
<script src='https://d3js.org/d3.v7.min.js'></script>
<script>
const data = {"xLabels": ["Mon", "Tue", "Wed", "Thu"], "yLabels": ["Week1", "Week2"], "values": [[1, 2, 3, 4], [2, 4, 1, 3]]};

(function(){
const container = d3.select('#viz');
const payload = data || {};
const xLabels = payload.xLabels || payload.labels || [];
const yLabels = payload.yLabels || payload.labelsY || [];
const values = payload.values || payload.matrix || payload.data || [];
if(!xLabels.length || !yLabels.length || !values.length){ container.append('div').text('No heatmap data (expect xLabels,yLabels,values matrix)'); return; }
const margin = {top:20,right:20,bottom:80,left:80};
const rect = container.node().getBoundingClientRect();
const width = Math.max(320, rect.width || container.node().clientWidth || window.innerWidth) - margin.left - margin.right;
const height = Math.max(240, rect.height || container.node().clientHeight || window.innerHeight) - margin.top - margin.bottom;
const gridWidth = width / xLabels.length;
const gridHeight = height / yLabels.length;
const svg = container.append('svg').attr('width', width + margin.left + margin.right).attr('height', height + margin.top + margin.bottom)
    .append('g').attr('transform',`translate(${margin.left},${margin.top})`);
// color scale
const flat = [].concat.apply([], values.map(r=>r.map(v=>+v||0)));
const minV = d3.min(flat), maxV = d3.max(flat);
const color = d3.scaleSequential(d3.interpolateYlOrRd).domain([minV||0, maxV||1]);
// cells
for(var yi=0;yi<yLabels.length;yi++){
    for(var xi=0;xi<xLabels.length;xi++){
        var v = values[yi] && values[yi][xi] != null ? values[yi][xi] : 0;
        svg.append('rect').attr('x', xi*gridWidth).attr('y', yi*gridHeight).attr('width', Math.max(1, gridWidth-1)).attr('height', Math.max(1, gridHeight-1)).style('fill', color(+v)).style('stroke','#fff').style('stroke-width',0.3)
            .on('mouseover', (function(xi,yi,v){ return function(event){ var tip = d3.select('body').append('div').attr('id','tmpTip').style('position','absolute').style('padding','6px 8px').style('background','#222').style('color','#fff').style('border-radius','6px').style('pointer-events','none'); tip.html(xLabels[xi] + ' / ' + yLabels[yi] + ': ' + v); }; })(xi,yi,v))
            .on('mousemove', function(event){ d3.select('#tmpTip').style('left',(event.pageX+12)+'px').style('top',(event.pageY+12)+'px'); })
            .on('mouseout', function(){ d3.select('#tmpTip').remove(); });
    }
}
// axes labels
const xg = svg.append('g').attr('transform',`translate(0,${height})`);
xg.selectAll('text').data(xLabels).enter().append('text').attr('x', (d,i)=>i*gridWidth + gridWidth/2).attr('y',12).attr('text-anchor','middle').text(d=>d).style('font-size','11px');
const yg = svg.append('g');
yg.selectAll('text').data(yLabels).enter().append('text').attr('x', -8).attr('y', (d,i)=>i*gridHeight + gridHeight/2).attr('text-anchor','end').text(d=>d).style('font-size','11px');
// legend swatches: simple gradient
var legend = d3.select('#legend'); legend.append('div').text('Heatmap scale');
})();

</script>
</body>
</html>
